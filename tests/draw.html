<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Canvas Tests</title>
	<script type="text/javascript" src="../src/o2.js"></script>
	<script type="text/javascript" src="../src/Mixin/Data.js"></script>
	<script type="text/javascript" src="../src/Mixin/Events.js"></script>
	<script type="text/javascript" src="../src/Mixin/Prop.js"></script>

	<script type="text/javascript" src="../src/Fairies/Mixin/GridProxy.js"></script>

	<script type="text/javascript" src="../src/Fairies/Tileset.js"></script>
	<script type="text/javascript" src="../src/Fairies/Animation.js"></script>
	<script type="text/javascript" src="../src/Fairies/Vector.js"></script>
	<script type="text/javascript" src="../src/Fairies/Flight.js"></script>
	<script type="text/javascript" src="../src/Fairies/Shape.js"></script>
	<script type="text/javascript" src="../src/Fairies/Rect.js"></script>
	<script type="text/javascript" src="../src/Fairies/Mobile.js"></script>
	<script type="text/javascript" src="../src/Fairies/Sprite.js"></script>
	<script type="text/javascript" src="../src/Fairies/Sector.js"></script>
	<script type="text/javascript" src="../src/Fairies/Collider.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wing.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wings/Linear.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wings/Gravity.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wings/BumpFloor.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wings/Shock.js"></script>
	<script type="text/javascript" src="../src/Fairies/Wings/Air.js"></script>
	<script type="text/javascript">


var oCanvas;
var oContext;
var aSquares = [];



function doomloop() {
	oContext.clearRect(0, 0, oCanvas.width, oCanvas.height);

	aSquares.forEach(function(s) {
		s.flap(32);
		s.render(oContext);
	});

}


function createMobile() {
	var s = new Fairy.Sprite();
	var m = new Fairy.Mobile();
	var f = new Fairy.Flight();
	m
		.flight(f)
		.shape(new Fairy.Rect())
		.sprite(s)
		.shape()
		.p1(new Fairy.Vector(-16, -16))
		.p2(new Fairy.Vector(16, 16));
	s.origin().set(16, 16);
	
	f.position().set(400, 300);
	
	
	var oImage = new Image();
	oImage.src = 'wdspr_xp.png';
	var ts = new Fairy.Tileset();
	ts.tiles(oImage).tileWidth(32).tileHeight(32);
	s.tileset(ts);
	
	var oAnim = new Fairy.Animation();
	oAnim.start(0).count(26).duration(32).loop(1);
	s.animations().push(oAnim);
	s.animation(0);

	oAnim = new Fairy.Animation();
	oAnim.start(32).count(9).duration(96).loop(1);
	s.animations().push(oAnim);
	//s.animation(0);
	
	return m;
}
	


function main() {
	oCanvas = document.getElementById('canvas');
	oContext = oCanvas.getContext('2d');
	var s = createMobile();
	aSquares.push(s);
	
	
	setInterval(doomloop, 32);
}

window.addEventListener('load', main);

	</script>
</head>
<body>
	<canvas id="canvas" width="800" height="600"></canvas>
</body>
</html>
